'use strict';

var GetIntrinsic = require('get-intrinsic');

var $TypeError = GetIntrinsic('%TypeError%');

var getIteratorMethod = require('es-abstract/helpers/getIteratorMethod');
var AdvanceStringIndex = require('es-abstract/2018/AdvanceStringIndex');
var Call = require('es-abstract/2018/Call');
var GetMethod = require('es-abstract/2018/GetMethod');
var IsArray = require('es-abstract/2018/IsArray');
var Type = require('es-abstract/2018/Type');

// https://262.ecma-international.org/6.0/#sec-getiterator

module.exports = function GetIterator(obj, method) {
	var actualMethod = method;
	if (arguments.length < 2) {
		actualMethod = getIteratorMethod(
			{
				AdvanceStringIndex: AdvanceStringIndex,
				GetMethod: GetMethod,
				IsArray: IsArray
			},
			obj
		);
	}
	var iterator = Call(actualMethod, obj);
	if (Type(iterator) !== 'Object') {
		throw new $TypeError('iterator must return an object');
	}

	return iterator;
};
